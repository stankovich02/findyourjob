function printJobs(e){let t="";if(0===e.length){t+='<h3 class="text-center mt-5 pt-3">There are no jobs that match your search criteria.</h3>',$("#allJobs").html(t);return}e.forEach(e=>{t+=e}),t+=`<nav aria-label="..." class="d-flex justify-content-center mt-5">
                        <ul class="pagination pagination-md">
                        </ul>
                    </nav>`,$("#allJobs").html(t)}$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),fetch("/api/cities").then(e=>e.json()).then(e=>{let t=e.map(e=>({label:e.name,value:e.id}));VirtualSelect.init({ele:"#Cities",options:t,multiple:!0,search:!0,maxWidth:"100%"})}),fetch("/api/technologies").then(e=>e.json()).then(e=>{let t=e.map(e=>({label:e.name,value:e.id}));if(VirtualSelect.init({ele:"#Technologies",options:t,multiple:!0,search:!0,maxWidth:"100%"}),localStorage.getItem("technology")){let a=localStorage.getItem("technology");document.querySelector("#Technologies").setValue(`${a}`),localStorage.removeItem("technology"),filterJobs(1)}}),$(document).ready(function(){if(localStorage.getItem("category")){let e=localStorage.getItem("category");$("#jobCategory").val(e),localStorage.removeItem("category"),filterJobs(1)}if(localStorage.getItem("keyword")){let t=localStorage.getItem("keyword");$("#jobKeyword").val(t),localStorage.removeItem("keyword"),filterJobs(1)}}),$("#filterJobs").click(function(e){e.preventDefault(),filterJobs(1)});let deleteButtons=document.querySelectorAll(".deleteJob a");function filterJobs(e){let t=$("#jobKeyword").val().trim(),a=$("#jobCategory").val(),o=$("#jobSeniority").val(),l=$("#Cities").val(),s=$("#workType").val(),i=$("#workPlace").val(),r=$("#Technologies").val(),n=$("#jobSalary").is(":checked"),c=$("#latestJobs").is(":checked");$.ajax({url:"/jobs/filter",method:"GET",data:{keyword:t,category:a,seniority:o,cities:l,technologies:r,workplace:i,workType:s,salary:n,latestJobs:c,page:e},success:function(e){printJobs(e.html),makePagination(e),$(document).on("click",".deleteJob a",function(e){e.preventDefault();let t=$(this).attr("data-id"),a=this.parentElement.nextElementSibling.querySelector(".jobName").innerHTML;$(".modal-body p").html(`Are you sure you want to delete "${a}" job?`),$(".deleteJobModal").css("display","block"),$("#closeModal").click(function(e){e.preventDefault(),$(".deleteJobModal").css("display","none")}),$("#deleteModal").click(function(){$.ajax({url:"/jobs/"+t,method:"DELETE",success:function(){location.reload()},error:function(e){toastr.error(e.message)}})})}),$(document).on("click",".boostJob a",function(e){e.preventDefault();let t=$(this).attr("data-id");$.ajax({url:`/jobs/${parseInt(t)}`,method:"GET",data:{jobId:t},success:function(e){html=`

               <p>Job Title: ${e.job.name}</p>
               <p>Job Category: ${e.job.category.name}</p>
                <p>Job Location: ${e.job.city.name}</p>
                <p>Application Deadline: ${e.job.application_deadline}</p>
                <label for="boostDuration">Choose Boost Duration:</label>
                <div id="calculateBoost">
                      <select class="form-select" aria-label="Default select example" id="boostDuration">
                        <option value="0">Select Duration</option>
                        <option value="1">1 Day</option>
                        <option value="3">3 Days</option>
                        <option value="7">7 Days</option>
                        <option value="14">14 Days</option>
                    </select>
                </div>

               `,$(".boostJobModal .modal-body").html(html),$(".boostJobModal").css("display","block"),$(".boostJobModal #closeModal").click(function(e){e.preventDefault(),$(".boostJobModal").css("display","none")}),$("#boostDuration").change(function(e){let a=`
                    <div id="calculationMessage">
                    </div>`;if($("#calculateBoost").append(a),0==$(this).val()){$("#calculationMessage").remove(),$(".boostJobModal form").remove();return}$(".boostJobModal form")&&$(".boostJobModal form").remove();let o=$(this).val(),l=5*o,s=$('meta[name="csrf-token"]').attr("content");$("#calculationMessage").html(`<h5 class="mt-5 text-success"> For ${o} ${1==o?"Day":"Days"}, You will be charged ${l} EUR.</h5>`);let i=`
                     <form action="/jobs/boost/${t}" method="post">
                        <input type="hidden" name="_token" value="${s}">
                        <input type="hidden" name="duration" value="${o}">
                        <input type="hidden" name="total" value="${l}">
                        <script
                            src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                            data-key="pk_test_51Or1PM08Wg9T2v5dxSHY09d2QRoPJlvI6AviM5HY8mKo4GJt7kUK6QayJ9bKiVy0lnXa9aJisPi4iL1qvM1QG6g8008evIG994"
                            data-amount="${100*l}"
                            data-name="Boost Job Payment"
                            data-image="http://127.0.0.1:8000/assets/img/logo.png"
                            data-locale="auto"
                            data-email="false"
                            data-currency="eur"
                            data-label="Pay">
                        </script>
                    </form>
                    `;$(".boostJobModal .modal-body").append(i)})},error:function(e){toastr.error(e.responseJSON.message)}})})},error:function(e){if(e.responseJSON.errors)for(let t in e.responseJSON.errors)toastr.error(e.responseJSON.errors[t][0]);e.responseJSON.error&&toastr.error(e.responseJSON.error)}})}function makePagination(e){let t=e.jobs.current_page,a=e.jobs.last_page,o="";if(a>1){o+=`<li class="page-item ${1===parseInt(t)?"disabled":""}">
                    <a class="page-link px-3 py-2" id="previousPage" href=""  aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="sr-only">Previous</span>
                    </a>
                </li>`;for(let l=1;l<=a;l++)l===t?o+=`
                    <li class="page-item active" aria-current="page">
                        <span class="page-link px-3 py-2">${l}</span>
                    </li>`:o+=`<li class="page-item"><a class="page-link px-3 py-2 pageLink" href="">${l}</a></li>`;o+=`<li class="page-item ${t===a?"disabled":""}" id="nextPage">
            <a class="page-link px-3 py-2" href="" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                        <span class="sr-only">Next</span>
                    </a>
                </li>`}$(".pagination").html(o),t<a&&$("#nextPage").click(function(e){e.preventDefault();let t=$(".page-item.active").next();t.className="page-item active";filterJobs($(t).children().text())}),t>1&&$("#previousPage").click(function(e){e.preventDefault();let t=$(".page-item.active").prev();t.className="page-item active";filterJobs($(t).children().text())}),$(".pageLink").click(function(e){e.preventDefault();filterJobs($(this).html())})}deleteButtons.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();let a=e.parentElement.nextElementSibling.querySelector(".jobName").innerHTML;$(".modal-body p").html(`Are you sure you want to delete "${a}" job?`),$(".deleteJobModal").css("display","block"),$("#closeModal").click(function(e){e.preventDefault(),$(".deleteJobModal").css("display","none")}),$("#deleteModal").click(function(){let t=e.getAttribute("data-id");$.ajax({url:"/jobs/"+t,method:"DELETE",success:function(){location.reload()},error:function(e){toastr.error(e.responseJSON.message)}})})})}),$(".pageLink").click(function(e){e.preventDefault();filterJobs($(this).html())}),$("#nextPage").click(function(e){e.preventDefault();let t=$(".page-item.active").next();t.className="page-item active";filterJobs($(t).children().text())}),$("#previousPage").click(function(e){e.preventDefault();let t=$(".page-item.active").prev();t.className="page-item active";filterJobs($(t).children().text())}),$(".saveJob").click(function(e){e.preventDefault();let t=$(this).attr("data-id"),a=this.querySelector("i");$.ajax({url:"/jobs/save/"+t,method:"POST",data:{jobID:t},success:function(e){"far fa-heart text-primary"===a.className?setTimeout(()=>{a.className="fas fa-heart text-primary"},1e3):setTimeout(()=>{a.className="far fa-heart text-primary"},1e3),setTimeout(()=>{toastr.success(e.message)},1e3)},error:function(e){if(e.responseJSON.errors)for(let t in e.responseJSON.errors)toastr.error(e.responseJSON.errors[t][0]);e.responseJSON.error&&toastr.error(e.responseJSON.error)}})});
